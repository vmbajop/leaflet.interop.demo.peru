<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mapa de pruebas de Leaflet</title>
  <link rel="stylesheet" href="libs/leaflet/leaflet.css" />
  <style>
    #map { height: 100vh; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="libs/leaflet/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([43.4917, -6.1106], 13); // Coordenadas de Pravia, Asturias
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    fetch('capaLocal.geoJSON')
        .then(response => response.json())
        .then(data => {
            L.geoJSON(data, {
                style: {
                    color: '#1976D2',
                    weight: 2,
                    opacity: 1,
                    fillColor: '#90CAF9',
                    fillOpacity: 0.4
                }
            }).addTo(map);
        })
        .catch(err => console.error('Error cargando capa local:', err));

    fetch('https://sig.asturias.es/servicios/services/ClasesAgroecologicas50000/MapServer/WFSServer?service=WFS&version=2.0.0&request=GetFeature&typeName=usos_agrarios&outputFormat=GEOJSON')
        .then(response => response.json())
        .then(data => {
            L.geoJSON(data, {
                style: {
                    color: '#333333',           // Borde gris oscuro
                    weight: 1,
                    opacity: 1,                 // Sin transparencia en el borde
                    fillColor: '#FFA94D',       // Naranja suave
                    fillOpacity: 0.5            // 50% de transparencia en el interior
                }
            }).addTo(map);
        })
        .catch(err => console.error('Error cargando WFS:', err));

    // Crear un div para mostrar las coordenadas
    
    var divCoordenadas = crearDivCoordenadas();
    document.body.appendChild(divCoordenadas);

    map.on('mousemove', function(e) {
      divCoordenadas.innerText = `Lat: ${e.latlng.lat.toFixed(5)}, Lng: ${e.latlng.lng.toFixed(5)}`;
    });

    map.on('mouseout', function() {
      divCoordenadas.innerText = 'Lat: , Lon: ';
    });

    function crearDivCoordenadas() {        
        var coordDiv = document.createElement('div');
        coordDiv.style.position = 'absolute';
        coordDiv.style.bottom = '10px';
        coordDiv.style.left = '10%';
        coordDiv.style.transform = 'translateX(-50%)';
        coordDiv.style.background = 'rgba(255,255,255,0.8)';
        coordDiv.style.padding = '4px 12px';
        coordDiv.style.borderRadius = '4px';
        coordDiv.style.fontFamily = 'monospace';
        coordDiv.style.fontSize = '14px';
        coordDiv.style.zIndex = 1000;
        coordDiv.innerText = 'Lat: , Lng: ';
        return coordDiv;
    }   
  </script>
</body>
</html>